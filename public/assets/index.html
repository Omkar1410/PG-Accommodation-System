<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>paying Guest accomadation system</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="/node_modules/bootstrap-icons/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/node_modules/bootstrap/dist/css/bootstrap.css">
    <link rel="stylesheet" href="/PBL_PROJECT/src/uservalidation.css">
    <script src="/node_modules/jquery/dist/jquery.js"></script>
    <script src="/node_modules/bootstrap/dist/js/bootstrap.bundle.js"></script>
    <script src="/node_modules/jquery.cookie/jquery.cookie.js"></script>
    <script src="/PBL_PROJECT/server/validation.js"></script>
    <style>
        #list li:hover {

            border: 1px solid white;
        }
    </style>
    <script>

        $(function () {

            
            $("#mybooking").click(function (e) {

                if($.cookie("UserId")!=undefined)
                {

                    e.preventDefault();
                        e.stopPropagation();
                        $.ajax({
                        method: "GET",
                        url: "Users/PgBookings.html",
                        })
                        .then(function (respone) {
                            // alert("omkar");
                        e.preventDefault();
                        e.stopPropagation();

                        // $("#details").hide();
                        $("#details").html(respone);
                        })
                }
                else
                {
                    alert("please login to see bookings");
                }
                        
              });
            $("#home").click()
            {
                $.removeCookie("pgName");
                $("#details").hide();
            }
            $("#details").on("click", ".card", function (e) {
                
                if($.cookie("UserId")!==undefined)
                {
                     e.preventDefault();
                    e.stopPropagation();

                    var pgNameText = $(this).find(".pgName").text();
                    var pgName = pgNameText.replace("PG Name:"," ").trim();

                    // $.removeCookie("pgName");
                    $.cookie("pgName", pgName);
                   

            

                    $.ajax({
                        method: "GET",
                        url: "./Users/Pgdetails.html"
                    })
                        .then(function (respone) {

                            e.preventDefault();
                            e.stopPropagation();

                            $("#section").html(respone);
                           
                            $.ajax({
                                    method: "GET",
                                    url: "http://127.0.0.1:4400/getpgdetails",
                                    success: function(data) {

            // console.log($.cookie("pgName"));
            // Assuming 'data' is an array of objects representing PG details
          
            for (var value of data) {
             
                if (value.forms!=undefined ) 
                {
                    if(value.forms.PgName===$.cookie("pgName"))
                    {

                        
                    $("#pgName").html(value.forms.PgName);

                    // Populate Type of PG radio buttons
                    
                    $("#typepg_boys").prop('checked', value.forms.PgType === 'Boys');
                    $("#typepg_girls").prop('checked', value.forms.PgType === 'Girls');
                    $("#typepg_both").prop('checked', value.forms.PgType === 'Both');
                    // Populate Location select
                    var location = value.forms.Location;
                    $("#city").html(location);

                    // Populate Rent Per Month input
                    $("#rpmonth").html(value.forms.RPmonth);
                    

                    // Populate Address textarea
                    $("#address").html(value.forms.Address);

                    // Populate Facilities checkboxes
                      // Handle "No" values for Facilities checkboxes
                      $("#electricity").prop('checked', value.forms.Electricity === 'No');
                    $("#parking").prop('checked', value.forms.Parking === 'No');
                    $("#refregerator").prop('checked', value.forms.Refregerator === 'No');
                    $("#furnished").prop('checked', value.forms.Furnished === 'No');
                    $("#ac").prop('checked', value.forms.Ac === 'No');
                    $("#balcony").prop('checked', value.forms.Balcony === 'No');
                    $("#table").prop('checked', value.forms.Table === 'No');
                    $("#laundry").prop('checked', value.forms.Laundry === 'No');
                    $("#security").prop('checked', value.forms.Security === 'No');
                  



                    $("#Electricity").prop('checked', value.forms.Electricity === 'Yes');
                    $("#Parking").prop('checked', value.forms.Parking === 'Yes');
                    $("#Refregerator").prop('checked', value.forms.Refregerator === 'Yes');
                    $("#Furnished").prop('checked', value.forms.Furnished === 'Yes');
                    $("#Ac").prop('checked', value.forms.Ac === 'Yes');
                    $("#Balcony").prop('checked', value.forms.Balcony === 'Yes');
                    $("#Table").prop('checked', value.forms.Table === 'Yes');
                    $("#Laundry").prop('checked', value.forms.Laundry === 'Yes');
                    $("#Security").prop('checked', value.forms.Security === 'Yes');

                  

                    // Populate Meals checkboxes
                    $("#breakfast").prop('checked', value.forms.Meals === 'Breakfast');
                    $("#lunch").prop('checked', value.forms.Meals === 'Lunch');
                    $("#dinner").prop('checked', value.forms.Meals === 'Dinner');
                   

                    }
                    else
                    {

                    }
                  
                    
                }
            }
        },
        error: function(xhr, status, error) {
            console.error("Error fetching PG details:", error);
        }
    });


                        })
                        
                }
                else
                {

                    alert("please login to view the PG details");
                }
                
            })
            $(document).ready(pgdetails);
            $(document).ready(checkownerlogin);
            function checkownerlogin() 
            {
              
                if ($.cookie("OwnerId") !== undefined) {
                    
                    $('#modallogin').prop('disabled', true);
                } else {
                 
                    $('#modallogin').prop('disabled', false);
                }
            }

            checkownerlogin();
            function pgdetails() {
             
                $.ajax({
    method: "GET",
    url: "http://127.0.0.1:4400/getpgdetails",
    success: function(data) {
        // Define an array of image paths
        var imagePaths = [
            "images/image1.avif",
            "images/image2.jpg",
            "images/image3.jpg",
            "images/image4.jpg",
            "images/image5.jpg",
            "images/image6.jpg",
        ];

        for (var i = 0; i < data.length; i++) {
            var value = data[i];

            if (value.forms !== undefined) {
                // Use modulo operator to cycle through imagePaths array
                var imagePath = imagePaths[i % imagePaths.length];

                $(`
                    <div id="pgComp" class="card me-5 mb-5" style="width:300px;">
                        <img src="${imagePath}" alt="Image" class="card-img-top" height="180px" width="180px">
                        <div class="card-header">
                            <h5 class="pgName">PG Name: ${value.forms.PgName}</h5>
                        </div>
                        <div class="card-body">
                            <div class="d-flex justify-content-around">
                                <p>Location: ${value.forms.Location}</p>&nbsp;
                                <p>Parking: ${value.forms.Parking}</p>
                            </div>
                            <div class="d-flex justify-content-around">
                                <p>Rent: ${value.forms.RPmonth}</p>&nbsp;
                                <p>Deposit: ${parseFloat(value.forms.RPmonth) * 2}/-</p>
                            </div>
                        </div>
                        <div class="card-footer">
                            <p><span class="fa-solid fa-location-dot">&nbsp;</span>${value.forms.Address}</p>
                            <p>Pune, Maharashtra</p>
                        </div>
                    </div>
                `).appendTo("#details");
            }
        }
    },
    error: function(xhr, status, error) {
        console.error("Error fetching PG details:", error);
    }
});


            }
            $("#owner").click(function (e) {
                e.preventDefault();
                    e.stopPropagation();
                if ($.cookie("UserId")!= undefined) {

                }
                else if ($.cookie("OwnerId")!= undefined) {


                    location.href = "Owner/PgOwnerRegister.html";

                }
                else if ($.cookie("OwnerId") == undefined) {

                    location.href = "Owner/PgOwnerRegister.html";
                }

            })

            $(document).ready(function () {
                // Event delegation to handle click on dynamically added .card elements within #details
                $("#details").on("click", ".card", function () {
                    // Extract details from the clicked .card element
                    var pgName = $(this).find(".pg-name").text().trim();
                    var pgType = $(this).find(".pg-type").text().trim();
                    var location = $(this).find(".location").text().trim();
                    var rpMonth = $(this).find(".rp-month").text().trim();
                    var roomImageSrc = $(this).find(".room-image").attr("src");

                    // Create a new Bootstrap card element with the extracted details
                    var newCardHtml = `
                    <div class="card mb-3">
                        <img src="${roomImageSrc}" class="card-img-top" alt="Room Image">
                        <div class="card-body">
                            <h5 class="card-title">${pgName}</h5>
                            <p class="card-text"><strong>PG Type:</strong> ${pgType}</p>
                            <p class="card-text"><strong>Location:</strong> ${location}</p>
                            <p class="card-text"><strong>Rent per Month:</strong> ${rpMonth}</p>
                        </div>
                    </div>
                `;

                    // Append the new card HTML to a container (e.g., #pgDetailsContainer)
                    $("#pgDetailsContainer").append(newCardHtml);
                });
            });


            $("#admin").click(function () {
                if ($.cookie("UserId") != undefined) {

                }
                else {
                    location.href = "Admin/Admin.html";

                }

            })
            $("#UserName").keyup(function (e) {
                e.preventDefault();
                e.stopPropagation();
                var user = $("#UserName").val();
                $.ajax({
                    method: "GET",
                    url: "http://127.0.0.1:4400/getusers",
                    success: function (data) {
                        for (var value of data) {
                            if (user == value.UserName) {

                                $("#userError").html("UserName already taken").css("color", "red");
                                return;
                            }
                            else {
                                $("#userError").html("UserName is available").css("color", "green");
                            }
                        }
                    }
                })
            })
            $("#modallogout").click(function (e) {
                $("#home").trigger("click");
                e.preventDefault();
                 e.stopPropagation();
                $("#details").hide();
                $.removeCookie("UserId");
                $("#logintext").html("LOGIN");
                $('#modallogin').prop('disabled', false);
                // $('#admin').attr('disabled',false);
                // $("#owner").attr('disabled',false);
              
                $("#modallogout").hide();
                location.reload();


            })
            $("#btnregister").click(function (e) {
                e.preventDefault();
                e.stopPropagation();
                if (formvalidation() == true) {
                    var userdata = {
                        "UserName": $("#UserName").val(),
                        "Password": $("#Password").val(),
                        "Mobile": $("#Mobile").val(),
                        "Email": $("#Email").val()

                    };


                    $.ajax({
                        method: "POST",
                        url: "http://127.0.0.1:4400/registeruser",
                        data: userdata
                    })
                    alert("Register successfully");
                    $("#UserName").val("");
                    $("#Password").val("");
                    $("#Mobile").val("");
                    $("#Email").val("");

                }

            })
            $("#btnlogin").click(function (e) {
    e.preventDefault();
    e.stopPropagation();

    var username = $("#UserNameL").val();
    var password = $("#PasswordL").val();

    $.ajax({
        method: "GET",
        url: "http://127.0.0.1:4400/getusers",
        success: function (data) {
            var user = data.find(u => u.UserName === username);

            if (user && user.Password === password) {
                // Save user login state in cookie
                $.cookie("UserId", user.UserName);

                // Update UI to reflect logged-in state
                $("#logintext").html(username);
                $('#modallogin').prop('disabled', true);
                $("#modallogout").show();

                // Clear login form fields
                $("#UserNameL").val("");
                $("#PasswordL").val("");

                alert("Login successful!");
            } else {
                alert("Invalid username or password");
            }
        },
        error: function (xhr, status, error) {
            console.error("Error fetching user data:", error);
            alert("Error occurred during login. Please try again.");
        }
    });
});

// Check if user is already logged in on page load
$(document).ready(function () {
    var loggedInUser = $.cookie("UserId");

    if (loggedInUser) {
        // Update UI to reflect logged-in state
        $("#logintext").html(loggedInUser);
        $('#modallogin').prop('disabled', true);
        $("#modallogout").show();
    }
});

            $("#UserName").blur(function () {
                
                $("#userError").hide();
            })
            function formvalidation() {
                console.log("form");
                var UserName = $("#UserName").val();
                var Password = $("#Password").val();
                var Mobile = $("#Mobile").val();
                var Email = $("#Email").val();
                var rgx = /^[a-zA-Z0-9]+$/;
                if (!rgx.test(UserName)) {
                    alert("Enter valid username format");
                    return false;
                }
                rgx = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/;
                if (!rgx.test(Password)) {
                    alert("Enter the correct password format");
                    return false;
                }
                rgx = /[0-9]{10}/;
                if (!rgx.test(Mobile)) {
                    alert("Enter the 10 digit mobile no");
                    return false;
                }
              
                rgx = /[a-zA-Z0-9._%+-]+@gmail\.com$/;
                if (!rgx.test(Email)) {
                    alert("Enter the correct Email format");
                    return false;
                }
                return true;
            }


  
   


        })

    </script>
</head>

<body class="container-fluid" style="background-color: gray;" id="top">

    <div>
        <h1 style=" text-shadow: 2px 2px 2px rgb(99, 96, 96); font-style: arial; color: rgb(26, 24, 24); "
            class="d-flex justify-content-center align-items-center h-100 mt-3 ms-0">Paying
            Guest Accomadation System</h1>
    </div>


    <nav class="nav navbar-expand-lg navbar-dark bg-dark  text-white m-3" id="#navigationbar" >
        <div class="container-fluid ">
            <button class="navbar-toggler " data-bs-target="#menu" data-bs-toggle="collapse">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="navbar-collapse collapse  justify-content-between" id="menu">
                <div>
                    <ul class="navbar-nav nav m-2 " id="list">
                        <li class="nav-item me-5 p-2 ">
                            <span class="nav-item-text bi bi-house-door">
                                <a href="index.html" class="text-decoration-none text-white" id="home">HOME</a>
                            </span>
                        </li>
                        <li class="nav-item me-5 p-2">
                            <span class="nav-item-text bi bi-house-door">
                                <a href="#" class="text-decoration-none text-white" id="mybooking">MY Bookings</a>
                            </span>
                        </li>
                        <li class="nav-item me-5 p-2">
                            <span class="nav-item-text bi bi-patch-question">
                                <a href="#footer" class="text-decoration-none text-white">ABOUT US</a>
                            </span>
                        </li>
                        <li class="nav-item me-5 p-2">
                            <span class="nav-item-text bi bi-person">
                                <a class="text-decoration-none text-white" id="owner">OWNER</a>
                            </span>
                        </li>
                        <li class="nav-item me-5 p-2">
                            <span class="nav-item-text bi bi-laptop">
                                <a href="#footer" class="text-decoration-none text-white">CONTACT US</a>
                            </span>
                        </li>
                        <li class="nav-item p-2">
                            <span class="nav-item-text bi bi-person-circle">
                                <a href="#" class="text-decoration-none text-white" id="admin">Admin</a>
                            </span>

                        </li>
                    </ul>

                </div>

                <div>
                    <button class="bg-black text-white me-3 " data-bs-toggle="modal" data-bs-target="#register">
                        <span class="bi bi-person">REGISTER</span>
                    </button>
                    <button class="bg-black text-white me-3" data-bs-toggle="modal" data-bs-target="#login"
                        id="modallogin">
                        <span class="bi bi-person" id="logintext">LOGIN </span>
                    </button>
                    <button class="bg-black text-white me-3" id="modallogout" style="display:none;">
                        <span class="bi bi-unlock" id="logout">LOGOUT</span>
                    </button>


                </div>

            </div>

    </nav>
    </div>
    <div class="modal fade" id="register">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <img src="/faviconhtml/public/assets/images/userimage.jpg" alt="image loading" height="100px"
                        width="130px">
                    <h1>Register</h1>
                    <button class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">

                    <dl>
                        <dt>User Name</dt>
                        <dd class="input-group-text"><span class="bi bi-person"></span><input type="text"
                                class="form-control" id="UserName" name="UserName" required
                                placeholder="Enter the username (only letters and numbers)" pattern="^[a-zA-Z0-9]+$"
                                minlength="4"></dd>
                        <p id="userError"></p>
                        <dt>Password</dt>
                        <dd class=" input-group-text"><span class="bi bi-lock"></span><input type="password"
                                class="form-control" id="Password" name="Password" required
                                placeholder="Enter the password"
                                pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$">
                        </dd>
                        <p id="pass">Password must contain at least 8 characters, including one uppercase letter,
                            one number,one special character</p>
                        <dt>Mobile no</dt>
                        <dd class="input-group-text"><span class="bi bi-phone"></span><input type="text"
                                class="form-control" id="Mobile" name="Mobile" required
                                placeholder="Enter the mobile no" pattern="[0-9]{10}"></dd>
                        <dt>Email</dt>
                        <dd class="input-group-text"><span class="bi bi-laptop"></span><input 
                                class="form-control" id="Email" name="Email" required  placeholder="Enter the Email id"
                                type="email" pattern="^[a-zA-Z0-9._%+-]+@gmail\.com$">
                        </dd>
                        <p>eg:xyz@gmail.com</p>
                    </dl>


                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" id="btnregister">Reigster</button>
                    <button class="btn btn-danger" data-bs-dismiss="modal">Cancel</button>
                </div>


            </div>
        </div>
    </div>
    <div class="modal fade" id="login">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>User Login</h3>
                    <button class=" btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <dl>
                        <dt>User Name</dt>
                        <dd class="input-group-text"><span class="bi bi-person"></span><input type="text"
                                class="form-control" name="username1" required placeholder="Enter the username"
                                id="UserNameL"></dd>

                        <dt>Password</dt>
                        <dd class=" input-group-text"><span class="bi bi-lock"></span><input type="password"
                                class="form-control" name="password1" required placeholder="Enter the password"
                                id="PasswordL"></dd>
                    </dl>

                </div>
                <div class="modal-footer">
                    <button class="btn btn-success" id="btnlogin">Login</button>
                </div>
            </div>
        </div>
    </div>
    <div>
        <div class="carousel slide carousel-dark d-flex justify-content-center" id="topbanner" data-bs-ride="carousel"
            data-bs-touch="false" class="mt-0">
            <div class="carousel-inner " style="height: 400px; width:1000px;">
                <div class="carousel-item active" data-bs-interval="5000">
                    <img src="images/pgcaroselimage4.jpg" class="d-block w-100" alt="image loading" height="400px">
                </div>
                <div class="carousel-item" data-bs-interval="5000">
                    <img src="images/pgcarouselimage1.webp" class="d-block w-100" alt="image loading" height="400px">
                </div>
                <div class="carousel-item" data-bs-interval="5000">
                    <img src="images/pgcaroselimage3.webp" class="d-block w-100" alt="image loading" height="400px">
                </div>
                <div class="carousel-item" data-bs-interval="5000">
                    <img src="images/pgcarouselimage4.webp" class="d-block w-100" alt="image loading" height="400px">
                </div>
                <button class="carousel-control-prev" data-bs-target="#topbanner" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon"></span>
                </button>
                <button class="carousel-control-next" data-bs-target="#topbanner" data-bs-slide="next">
                    <span class="carousel-control-next-icon"></span>
                </button>

            </div>
        </div>

    </div>

    </header>
    <section id="section" class=" d-flex justify-content-center align-content-center p-lg-5" >
        <div id="details" class="d-flex  mt-3 p-5"
            style=" justify-content:space-evenly; flex-wrap:wrap;">

        </div>




    </section>
    <footer id="footer" style="background-color:#37475a; margin: -13px;">
        <div style="height:50px; width: 100%; text-align: center;" class="p-3">
            <a href="#top" style="color: white; text-decoration: none;">Back to Top</a>
        </div>
        <div style="background-color: #222f3d;" class="p-5">
            <div style="display: grid; grid-template-columns: 6fr 6fr;" class="text-white">
                <div class="d-flex justify-content-center align-content-center">
                    <div style="text-align: center;">
                        <h3>About Us</h3>
                        <h4 style="color: orange;">Paying Guest Accomodation System</h4><br>
                        <p>
                            Welcome to Paying Guest Accommodation System, your ideal solution for student housing needs.
                            At
                            PGAS, we understand the unique requirements of students and strive to provide comfortable,
                            affordable, and convenient accommodations that support your academic journey.
                            Paying Guest Accommodation System is a dedicated provider of student housing solutions. Our
                            team is
                            committed to offering a safe, welcoming, and inclusive environment where students can thrive
                            academically and socially.
                        </p>

                    </div>

                </div>

                <div class="d-flex justify-content-center align-content-center">
                    <div style="text-align: center;">
                        <h3>Contact Us</h3>
                        <h4 style="color: orange;">Paying Guest Accomodation System</h4><br>
                        <div class="details">
                            <ul style="list-style: none;">
                                <li><i class="fa-solid fa-phone"></i> +91 9130049369</li><br>
                                <li><i class="fa-solid fa-envelope"></i> pgasinfo@gmail.com</li><br>
                                <li><i class="fa-solid fa-location-dot"></i> Trimurti Chowk,Dhankawadi,Pune-43</li><br>
                                <li>Follow Us on
                                    <i class="fa-brands fa-facebook"
                                        style="font-size: 30px; color:rgb(23, 158, 211);">&nbsp;</i>
                                    <i class="fa-brands fa-square-instagram"
                                        style="font-size: 30px; color:rgb(234, 21, 56);"></i>
                                </li>
                            </ul>
                        </div>
                    </div>


                </div>
            </div>
            <hr style="color: white;">
            </hr>
            <div style="text-align: center; color: white;">
                Paying Guest Accommodation System © 2024. All Rights Reserved.
            </div>
            <div style="height: 50px;">

            </div>
        </div>

    </footer>
</body>

</html>